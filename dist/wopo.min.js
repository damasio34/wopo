!function(e){"use strict";e.module("wopo.services",[]);var n=e.module("wopo",["wopo.services"]);n.provider("$wopo",function(){var e,n,o=!0;this.setAppId=function(n){e=n},this.setRestApiKey=function(e){n=e},this.setUsuarioPrecisaEstarAutenticado=function(e){o=e},this.$get=function(){return e||console.error("A configuração APP_ID não foi definida"),n||console.error("A configuração REST_API_KEY não foi definida"),{APP_ID:e,REST_API_KEY:n,UsuarioPrecisaEstarAutenticado:o}}})}(angular),function(e,n){n||console.error("É necessário importar a biblioteca cryptojs.js");var o=e.module("wopo.services");o.factory("CryptSha1Service",function(){var e=function(){this.hash=function(e){var o=JSON.stringify(e);return n.SHA1(o).toString()}};return new e})}(angular,CryptoJS),function(e){var n=e.module("wopo.services");n.service("FormHelperService",function(n,o,t){var r=this,i=function(e){r.defaultRoute=e},u=function(e){return e.enabledValidations=!e.enabledValidations,e.enabledValidations},a=function(e,o,i){return o.incluir(e).success(function(e){t.alert("Sucesso","Dados cadastrados com sucess!",3e3),n.path(r.defaultRoute)},function(e){throw e})},s=function(n,o,t){return o.editar(n).success(function(o){t.OriginalModel=e.copy(n)},function(e){throw e})},c=function(e){if(!e.formulario)throw"Objeto Formulário não definido";return e.formulario.$valid},f=function(e){return e.formularioEhValido()&&e.usuarioAlterouFormulario()},l=function(e,n){if(e.formulario=n,e.formularioEhValido()){if(e.modoEdicao){if(!e.usuarioAlterouFormulario())return;return e.salvarAlteracao()}return e.salvarInclusao()}},d=function(n){return!e.equals(n.Model,n.OriginalModel)},h=function(n){return e.copy(n.OriginalModel,n.Model),n.Formulario.$setPristine()},m=function(e){return null===e||void 0===e},g=function(e,n,o){n.modoEdicao=!0;var t=function(e,n,o,t,r){o.getById(e).success(function(e){var o=!!e;o&&n.edit(e),t(e,e,o)},function(e){throw e})};return new Promise(function(r,i){n.$config?configuracoesService.getByKey(n.$config).then(function(u){n.$config=u,t(e,n,o,r,i)}):t(e,n,o,r,i)})},v=function(n,o){o.modoEdicao=!0,o.Model=n,o.OriginalModel=e.copy(n)},p=function(n,o){var t=n||{};o.Model=t,o.OriginalModel=e.copy(t),o.carregado=!0},S=function(e){e.usuarioAlterouFormulario()?t.confirm("Alteração não salvas","Deseja sair sem salvar as alterações?",function(){n.path(r.defaultRoute)}):n.path(r.defaultRoute)};this.applySettings=function(e,n,o){if(!n)throw"Variável '$scope' precisa ser definda";n.enabledValidations=!0,n.salvarInclusao=function(){return a(n.Model,o,n)},n.salvarAlteracao=function(){return s(n.Model,o,n)},n.formularioEhValido=function(){return c(n)},n.canSubmit=function(){return f(n)},n.submitForm=function(e){return l(n,e)},n.usuarioAlterouFormulario=function(){return d(n)},n.desfazerAlteracoesDoUsuario=function(){return h(n)},n.sair=function(){return S(n)},n.edit=function(e){return v(e,n)},e.editById=function(e){return g(e,n,o)},e.novoRegistro=function(e){return p(e,n,o)},e.isNullOrUndefined=function(e){return m(e)},e.setDefaultRoute=function(e){return i(e)},n.habilitarOuDesabilitarValidacao=function(){return u(n)},n.ExcluirModal=function(e,t){return _excluirModal(e,t,n,o)},e.confirmar=function(e,o){return _confirmar(n,e,o)}}})}(angular),function(e){var n=e.module("wopo.services");n.factory("IonicPopupService",function(e,n){var o=function(){this.alert=function(o,t,r){var i=e.alert({title:o,template:t});n(function(){i.close()},r)},this.confirm=function(n,o,t,r){var i=e.confirm({title:n,template:o});i.then(function(e){e?t():r()})}};return new o})}(angular),function(e){var n=e.module("wopo.services");n.service("ListHelperService",function(){var e=function(e,n){return e.getAll().success(function(e){n.itens=e.results},function(e){throw e})},n=function(n,o){e(n,o).success(function(){o.$broadcast("scroll.refreshComplete")},function(e){throw e})},o=function(e,n,o){return e.excluir(o.objectId).success(function(e){n.itens.splice(n.itens.indexOf(o),1)},function(e){throw e})};this.applySettings=function(t,r,i){if(!r)throw"Variável '$scope' precisa ser definda";if(!r)throw"Variável '$modelService' precisa ser definda";r.queryBuscar&&(r.limparBuscar=function(){r.queryBuscar=""}),t.listarItens=function(){return e(i,r)},r.atualizarItens=function(){return n(i,r)},r.excluirItem=function(e){return o(i,r,e)}}})}(angular),function(e){var n=e.module("wopo.services");n.factory("RestServiceBase",function(e,n,o){var t=function(){self=this,this.mainRoute=void 0,this.urlBase="https://api.parse.com/1/classes/",this.getToken=function(){var e=o.getLocalStorage("_$token")||o.getSessionStorage("_$token");if(e)return e;throw"Usuário não autenticado, efetue login"},this.headers={"X-Parse-Application-Id":n.APP_ID,"X-Parse-REST-API-Key":n.REST_API_KEY},n.UsuarioPrecisaEstarAutenticado&&(self.headers["X-Parse-Session-Token"]=this.getToken()),this.setMainRoute=function(e){self.mainRoute=e},this.getAll=function(){if(!self.mainRoute)throw"mainRoute não configurada.";return e.get(self.urlBase+self.mainRoute,{headers:self.headers})},this.getById=function(n){if(!n)throw"id não informado";if(!this.mainRoute)throw"mainRoute não configurada.";return e.get(self.urlBase+self.mainRoute+"/"+n,{headers:self.headers})},this.incluir=function(n){if(!self.mainRoute)throw"mainRoute não configurada.";return e.post(self.urlBase+self.mainRoute,n,{headers:self.headers})},this.editar=function(n){if(!this.mainRoute)throw"mainRoute não configurada.";return e.put(self.urlBase+self.mainRoute+"/"+n.objectId,n,{headers:self.headers})},this.excluir=function(n){if(!this.mainRoute)throw"mainRoute não configurada.";return e["delete"](self.urlBase+self.mainRoute+"/"+n,{headers:self.headers})}};return t})}(angular),function(e){var n=e.module("wopo.services");n.factory("WebStorageService",function(){var e=function(){this.setLocalStorage=function(e,n){n&&(localStorage[e]=JSON.stringify(n))},this.getLocalStorage=function(e){return localStorage[e]?JSON.parse(localStorage[e]):null},this.setSessionStorage=function(e,n){n&&(sessionStorage[e]=JSON.stringify(n))},this.getSessionStorage=function(e){return sessionStorage[e]?JSON.parse(sessionStorage[e]):null}};return new e})}(angular);